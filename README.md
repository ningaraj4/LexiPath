# LexiPath - AI Vocabulary Learning Platform

LexiPath is a production-ready, scalable AI-powered vocabulary learning platform that provides personalized daily content, adaptive quizzes, and intelligent weekly planning. Built with Go backend and Android Compose frontend.

## 🚀 Features

### Core Features
- **Firebase Authentication** - Email/password, Google Sign-in, Phone OTP
- **AI-Powered Content** - Daily vocabulary generated by Gemini 2.5 Pro
- **Adaptive Learning** - Mastery tracking with spaced repetition
- **Offline Support** - Full offline capability with background sync
- **Background Tasks** - Daily content prefetching and weekly planning
- **Home Screen Widget** - Quick access to today's word and quiz
- **Bilingual & Industry Tracks** - Language learning and professional vocabulary

### Technical Stack
- **Backend**: Go 1.22, Gin, PostgreSQL, Redis, Firebase Admin SDK
- **Android**: Kotlin, Jetpack Compose, Hilt, Room, WorkManager, Glance
- **AI**: Google Gemini 2.5 Pro with strict JSON validation
- **Deployment**: Docker, Cloud Run, Cloud SQL, MemoryStore Redis

## 📁 Project Structure

```
LexiPath/
├── backend/                 # Go backend service
│   ├── internal/
│   │   ├── config/         # Environment configuration
│   │   ├── handlers/       # HTTP request handlers
│   │   ├── middleware/     # Auth, logging, CORS middleware
│   │   ├── models/         # Data models and DTOs
│   │   ├── repositories/   # Data access layer
│   │   └── services/       # Business logic layer
│   ├── migrations/         # PostgreSQL schema migrations
│   ├── Dockerfile          # Multi-stage Docker build
│   ├── docker-compose.yml  # Local development setup
│   └── Makefile           # Build and deployment commands
├── app/                    # Android application
│   └── src/main/java/com/example/lexipath/
│       ├── data/          # Repository, API, local database
│       ├── di/            # Hilt dependency injection
│       ├── ui/            # Compose UI screens and ViewModels
│       ├── workers/       # Background WorkManager tasks
│       └── widget/        # Glance home screen widget
└── docs/                  # Documentation (generated)
```

## 🛠️ Quick Start

### Prerequisites
- Go 1.22+
- Android Studio Hedgehog+
- Docker & Docker Compose
- Firebase project with Authentication enabled
- Google Cloud project with Gemini API access

### Backend Setup

1. **Clone and configure**:
```bash
cd backend
cp .env.example .env
# Edit .env with your configuration
```

2. **Start dependencies**:
```bash
docker-compose up -d postgres redis
```

3. **Run migrations**:
```bash
make migrate-up
```

4. **Start backend**:
```bash
make run
# Or with Docker: make docker-run
```

### Android Setup

1. **Configure Firebase**:
   - Download `google-services.json` to `app/`
   - Enable Authentication methods in Firebase Console

2. **Update configuration**:
   - Set `BASE_URL` in `app/build.gradle.kts` for your backend
   - Configure signing keys for release builds

3. **Build and run**:
```bash
./gradlew assembleDebug
# Or open in Android Studio
```

## 📖 API Documentation

### Authentication
All API endpoints require Firebase ID token in Authorization header:
```
Authorization: Bearer <firebase-id-token>
```

### Core Endpoints

#### Profile Management
```http
POST /api/profile
Content-Type: application/json

{
  "goalType": "bilingual_language_track",
  "languageLevel": "intermediate",
  "targetLanguage": "Spanish",
  "nativeLanguage": "English"
}
```

#### Daily Content
```http
GET /api/content/today?date=2024-01-15
```

#### Quiz Submission
```http
POST /api/quiz/submit
Content-Type: application/json

{
  "contentId": "uuid",
  "type": "mcq",
  "userAnswer": "correct answer",
  "isCorrect": true,
  "timeSpentMs": 5000
}
```

#### Weekly Planning
```http
GET /api/weekly-plan?weekStart=2024-01-14
POST /api/weekly-plan/generate
```

## 🏗️ Architecture

### Backend Architecture
- **Clean Architecture** with clear separation of concerns
- **Repository Pattern** for data access abstraction
- **Service Layer** for business logic
- **Middleware** for cross-cutting concerns (auth, logging, metrics)

### Android Architecture
- **MVVM** with Compose UI and ViewModels
- **Repository Pattern** combining local cache and remote API
- **Dependency Injection** with Hilt
- **Offline-First** with Room database caching

### Data Flow
1. **Authentication**: Firebase handles user auth, backend verifies tokens
2. **Content Generation**: Gemini AI creates personalized vocabulary
3. **Caching Strategy**: Redis for backend, Room for Android offline support
4. **Background Processing**: WorkManager schedules daily/weekly tasks
5. **Widget Updates**: Glance widget shows latest content

## 🚀 Deployment

### Backend Deployment (Cloud Run)
```bash
# Build and push container
make docker-build
docker tag lexipath-backend gcr.io/PROJECT-ID/lexipath-backend
docker push gcr.io/PROJECT-ID/lexipath-backend

# Deploy to Cloud Run
gcloud run deploy lexipath-backend \
  --image gcr.io/PROJECT-ID/lexipath-backend \
  --platform managed \
  --region us-central1 \
  --allow-unauthenticated
```

### Android Deployment
```bash
# Build release APK
./gradlew assembleRelease

# Or build AAB for Play Store
./gradlew bundleRelease
```

## 🧪 Testing

### Backend Tests
```bash
make test
make test-coverage
```

### Android Tests
```bash
# Unit tests
./gradlew testDebugUnitTest

# Integration tests
./gradlew connectedDebugAndroidTest
```

## 📊 Monitoring

### Backend Metrics
- Prometheus metrics endpoint: `/metrics`
- Health check endpoint: `/health`
- Structured logging with request IDs

### Performance Monitoring
- Database query performance tracking
- API response time monitoring
- Background job success rates

## 🔧 Configuration

### Environment Variables (Backend)
```bash
PORT=8080
DATABASE_URL=postgres://user:pass@localhost/lexipath
REDIS_URL=redis://localhost:6379
GEMINI_API_KEY=your-gemini-api-key
FIREBASE_PROJECT_ID=your-firebase-project
TIMEZONE=America/New_York
```

### Build Configuration (Android)
```kotlin
buildTypes {
    debug {
        buildConfigField("String", "BASE_URL", "\"http://10.0.2.2:8080\"")
    }
    release {
        buildConfigField("String", "BASE_URL", "\"https://your-backend.run.app\"")
    }
}
```

## 🤝 Contributing

1. Fork the repository
2. Create feature branch: `git checkout -b feature/amazing-feature`
3. Commit changes: `git commit -m 'Add amazing feature'`
4. Push to branch: `git push origin feature/amazing-feature`
5. Open Pull Request

## 📄 License

This project is licensed under the MIT License - see the [LICENSE](LICENSE) file for details.

## 🆘 Support

For support and questions:
- Create an issue in the GitHub repository
- Check the [API Documentation](docs/api_contract.md)
- Review the [Setup Guide](docs/setup.md)
